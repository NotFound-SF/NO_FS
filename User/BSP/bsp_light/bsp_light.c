
/*
*********************************************************************************************************
*                                              INCLUDE FILES
*********************************************************************************************************
*/

#include "bsp_light.h"
#include "bsp_adc.h"


/*
*********************************************************************************************************
*********************************************************************************************************
**                                         GLOBAL FUNCTIONS
*********************************************************************************************************
*********************************************************************************************************
*/




/*
*********************************************************************************************************
*                                             BSP_Light_State()
*
* Description : 获获取光照水平
*
* Argument(s) : none
*
* Return(s)   : High_Level, Normal_Level
*
* Caller(s)   : Application.
*
* Note(s)     : none.
*********************************************************************************************************
*/
Light_Level  BSP_Light_State (void)
{
	uint8_t   count = 0;
	OS_ERR    err;
	
	if (BSP_ADC_GetDat(BSP_ADC_CH2) > HIGH_LIGHT_VALUE) {
		for (count = 0; count < 10; count++) {
			
			OSTimeDlyHMSM( 0, 0, 0, 4,
		               OS_OPT_TIME_HMSM_STRICT,
                       &err );
			
			if (BSP_ADC_GetDat(BSP_ADC_CH2) < HIGH_LIGHT_VALUE) 
				break;			
		}
	}
	
	if (10 == count)
		return Light_High_Level;

	return Light_Normal_Level;	
}

